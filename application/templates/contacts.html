{% extends "base_no_turbo.html" %}

{% block main_content %}
<body style="overflow-x: hidden;">
    <nav class="navbar navbar-expand-lg navbar-light bg-ubuntu">
        <a class="navbar-brand text-white" href="#">SHERPA</a>
        <button class="navbar-toggler" type="button" data-target="#navbarNav" data-toggle="collapse"  aria-label="Toggle navigation" aria-controls="navbarNav" aria-expanded="false">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link text-white" href="{{ url_for('home') }}">Home <span class="sr-only">(current)</span></a>
            </li>
          <li class="nav-item">
            <a class="nav-link text-white" href="{{ url_for('contacts_bp.contacts') }}">Contacts</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-white" href ="{{url_for('deals_bp.deals')}}">Deals</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-white" href="{{ url_for('teams.team') }}">Team</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-white" href="#">Profile</a>
          <li class="nav-item">
            <a  class="nav-link text-white" onclick="logout();" href="{{ url_for('auth.profile') }}">Logout</a>
          </li>
        </ul>
      </div>
    </nav>

    <h1>
        Contacts
    </h1>
    
    <section id="contacts">
        <div class="row">
            <div class="col-md-2">
              <section id="contact_filter_buttons">
                <div class="list-group">
                    <a href="{{url_for('contacts_bp.contacts', prev_sort='None', order='ASC', sort='None', filter='all', page=1 , error='None')}}"class="list-group-item mb-2">All Contacts</a>
                    <a href="{{url_for('contacts_bp.contacts', prev_sort='None', order='ASC', sort='None', filter='assigned', page=1 , error='None')}}"class="list-group-item mb-2">My Assigned Contacts</a>
                    <a href="{{url_for('contacts_bp.contacts', prev_sort='None', order='ASC', sort='None', filter='unassigned', page=1 , error='None')}}"class="list-group-item mb-2">Unassigned Contacts</a>
                </div>
              </section>
            </div>
        <div class="col-md-10">
            <table class="table table-bordered table-striped table-responsive">
                <form action="" method="POST" novalidate>
                    {{ search_form.hidden_tag() }}
                    <tr>--
                        <td>{{ search_form.search_bar }}</td>
                        <td>{{ search_form.submit(id="contacts_search_button") }}</td>
                    </tr>
                </form>
                {% set prev_sort = sort %}
                <thead class="thead-dark"></thead>
                    <tr class="table-dark">
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='name', page=page, filter=filter, error='None') }}">Name</a></th>
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='email', page=page, filter=filter, error='None') }}">Email</a></th>
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='phone_number', page=page, filter=filter, error='None') }}">Phone Number</a></th>
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='contact_owner', page=page, filter=filter, error='None') }}">Contact Owner</a></th>
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='company', page=page, filter=filter, error='None') }}">Company</a></th>
                        <th><a href="{{ url_for('contacts_bp.contacts', prev_sort=prev_sort, order=order, sort='status', page=page, filter=filter, error='None') }}">Status</a></th>
                        <th class="contacts_table_heading">Edit Contact</th>
                        <th class="contacts_table_heading">Remove Contact</th>
                    </tr>
                </thread>
                <tbody>
                    <section id="edit-table" class="edit-table">
                        {% for form in forms %}
                        <tr>
                            <form action="{{ url_for('contacts_bp.edit_contact', contact_id=form.contact_id.data, prev_sort=prev_sort, order=order, sort=sort, filter=filter, page=page, error=error, num_pages=num_pages) }}" method="POST">
                                {{ form.hidden_tag() }}
                                <td>
                                    <a id="view_contact" href="{{ url_for('contact_bp.contact', contact_id=form.contact_id.data, activity='activity') }}">View</a>
                                    {{ form.name(id="name_input_contact") }}
                                    {% for error in form.name.errors %}
                                    <div>{{ error }}</div>
                                    {% endfor %}
                                </td>
                                <td>
                                    {{ form.email() }}
                                    {% for error in form.email.errors %}
                                    <div>{{ error }}</div>
                                    {% endfor %}
                                </td>
                                <td>{{ form.phone_number() }}</td>
                                <td>
                                    {% for error in form.contact_owner.errors %}
                                    <div>{{ error }}</div>
                                    {% endfor %}
                                    {{ form.contact_owner() }}
                                </td>
                                <td>{{ form.company() }}</td>
                                <td>{{ form.status(class="contacts_status") }}</td>
                                <td>{{ form.submit(value='Save Changes', class="contact_save_add_button") }}</td>
                            </form>
                            <td><a id="remove_contact" href="{{ url_for('contacts_bp.remove_contact', contact_id=form.contact_id.data, prev_sort=prev_sort, order=order, sort=sort, filter=filter, page=page, error=error) }}">Remove</a></td>

                            </tr>

                            {% endfor %}
                            </section>
                            <tr>
                                <form action="{{url_for('contacts_bp.add_contact', prev_sort=prev_sort, order=order, sort=sort, filter=filter, page=page, error=error)}}" method="POST">
                                    {{add_contact.hidden_tag()}}
                                
                                    <td>{{add_contact.name()}}
                                        {% for error in add_contact.name.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </td>
                                
                                    <td>{{add_contact.email()}}
                                        {% for error in add_contact.email.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </td>
                                
                                    <td>{{add_contact.phone_number()}}</td>
                                
                                    <td>{{add_contact.contact_owner()}}</td>
                                
                                    <td>{{add_contact.company()}}</td>
                                
                                    <td>{{add_contact.status(class_="contacts_status")}}</td>
                                
                                    <td>{{add_contact.submit(value='Add Contact', class_="contact_save_add_button")}}</td>
                            
                                </form>
                            </tr>
                        </table>
 <section>
    {% if error != 'None' %} 
        <p>{{error}}</p>
    {% endif %}
</section>
<section>
    {% set next_page = page + 1 %}
    {% set previous_page = page - 1 %}
    <br>
    {% if page > 1 %}
        <p><a href = "{{url_for('contacts_bp.contacts',error=error, filter=filter, order=order, prev_sort=prev_sort, sort=sort, page=previous_page)}}">Previous Page</a></p>
    {% endif %}

    {% if page < num_pages %}
        <p><a href = "{{url_for('contacts_bp.contacts', error=error, filter=filter, order=order, prev_sort=prev_sort, sort=sort, page=next_page)}}">Next Page</a></p>
    {% endif %}
    
</section>
        </div>
        </div>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
{% endblock %} 